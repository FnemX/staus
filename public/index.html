<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>1914</title>
  <style>
    /* 基础样式 */
    :root {
      --primary: #60a5fa;
      --secondary: #34d399;
      --warning: #fbbf24;
      --danger: #f87171;
      --dark: #0a0a0a;
      --gray-100: #1a1a1a;
      --gray-200: #2d2d2d;
      --gray-300: #404040;
      --gray-400: #666666;
      --gray-500: #999999;
      --gray-600: #cccccc;
      --gray-700: #e6e6e6;
      --gray-800: #f5f5f5;
      --accent: #8b5cf6;
      --shadow-sm: 0 1px 3px 0 rgba(0, 0, 0, 0.4);
      --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.5), 0 2px 4px -1px rgba(0, 0, 0, 0.4);
      --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.6), 0 4px 6px -2px rgba(0, 0, 0, 0.5);
      --gradient-primary: linear-gradient(135deg, #60a5fa 0%, #3b82f6 100%);
      --gradient-secondary: linear-gradient(135deg, #34d399 0%, #10b981 100%);
      --gradient-warning: linear-gradient(135deg, #fbbf24 0%, #f59e0b 100%);
      --gradient-danger: linear-gradient(135deg, #f87171 0%, #ef4444 100%);
      --gradient-accent: linear-gradient(135deg, #8b5cf6 0%, #7c3aed 100%);
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
      background-color: var(--dark);
      min-height: 100vh;
      color: var(--gray-600);
      /* 自定义滚动条 */
      scrollbar-width: thin;
      scrollbar-color: var(--gray-400) var(--dark);
    }

    /* Webkit浏览器滚动条样式 */
    ::-webkit-scrollbar {
      width: 8px;
      height: 8px;
    }

    ::-webkit-scrollbar-track {
      background: var(--dark);
      border-radius: 4px;
    }

    ::-webkit-scrollbar-thumb {
      background: var(--gray-400);
      border-radius: 4px;
      border: 1px solid var(--dark);
      transition: all 0.3s ease;
    }

    ::-webkit-scrollbar-thumb:hover {
      background: var(--primary);
      transform: scale(1.1);
    }

    ::-webkit-scrollbar-corner {
      background: var(--dark);
    }

    .container {
      max-width: 1400px;
      margin: 0 auto;
      padding: 0 16px;
      width: 100%;
    }

    @media (max-width: 1400px) {
      .container {
        max-width: 1200px;
      }
    }

    @media (max-width: 1200px) {
      .container {
        max-width: 992px;
      }
    }

    @media (max-width: 992px) {
      .container {
        max-width: 768px;
      }
    }

    @media (max-width: 768px) {
      .container {
        max-width: 576px;
        padding: 0 12px;
      }
    }

    @media (max-width: 576px) {
      .container {
        max-width: 100%;
        padding: 0 8px;
      }
    }

    /* 顶部导航栏 */
    header {
      background: var(--gradient-primary);
      color: white;
      padding: 12px 0;
      box-shadow: var(--shadow-lg);
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    }

    @media (min-width: 768px) {
      header {
        padding: 16px 0;
      }
    }

    .header-content {
      display: flex;
      justify-content: space-between;
      align-items: center;
      flex-wrap: wrap;
      gap: 12px;
    }

    @media (max-width: 480px) {
      .header-content {
        flex-direction: column;
        align-items: flex-start;
        gap: 8px;
      }
    }

    .logo {
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .logo-icon {
      font-size: 20px;
      display: inline-block;
      width: 20px;
      height: 20px;
      text-align: center;
    }

    .logo-text {
      font-size: 18px;
      font-weight: bold;
    }

    @media (min-width: 768px) {
      .logo-icon {
        font-size: 24px;
        width: 24px;
        height: 24px;
      }
      
      .logo-text {
        font-size: 20px;
      }
    }

    .system-info {
      font-size: 12px;
      display: none;
      text-align: right;
    }

    @media (min-width: 1024px) {
      .system-info {
        font-size: 14px;
        display: block;
      }
    }

    /* 状态卡片 */
    .dashboard {
      padding: 24px 0;
    }

    .cards-grid {
      display: grid;
      grid-template-columns: 1fr;
      gap: 16px;
      margin-bottom: 24px;
    }

    @media (min-width: 480px) {
      .cards-grid {
        grid-template-columns: repeat(2, 1fr);
        gap: 20px;
      }
    }

    @media (min-width: 768px) {
      .cards-grid {
        grid-template-columns: repeat(3, 1fr);
        gap: 24px;
      }
    }

    @media (min-width: 1024px) {
      .cards-grid {
        grid-template-columns: repeat(4, 1fr);
      }
      .system-info {
        display: block;
      }
    }

    @media (min-width: 1200px) {
      .cards-grid {
        grid-template-columns: repeat(6, 1fr);
      }
    }

    @media (min-width: 1400px) {
      .cards-grid {
        grid-template-columns: repeat(6, 1fr);
        gap: 28px;
      }
    }

    .status-card {
      background: linear-gradient(145deg, var(--gray-200), var(--gray-300));
      border-radius: 12px;
      padding: 16px;
      box-shadow: var(--shadow-md);
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      border: 1px solid rgba(255, 255, 255, 0.05);
      position: relative;
      overflow: hidden;
    }

    @media (min-width: 768px) {
      .status-card {
        padding: 20px;
      }
    }

    @media (min-width: 1024px) {
      .status-card {
        padding: 24px;
      }
    }

    .status-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.1), transparent);
      transition: left 0.6s;
    }

    .status-card:hover {
      transform: translateY(-4px) scale(1.02);
      box-shadow: var(--shadow-lg);
    }

    .status-card:hover::before {
      left: 100%;
    }

    .card-header {
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      margin-bottom: 12px;
    }

    @media (min-width: 768px) {
      .card-header {
        margin-bottom: 16px;
      }
    }

    .card-info {
      display: flex;
      flex-direction: column;
    }

    .card-label {
      font-size: 12px;
      color: var(--gray-500);
    }

    @media (min-width: 768px) {
      .card-label {
        font-size: 14px;
      }
    }

    .card-value {
      font-size: 20px;
      font-weight: bold;
    }

    @media (min-width: 768px) {
      .card-value {
        font-size: 24px;
      }
    }

    .card-icon {
      width: 48px;
      height: 48px;
      border-radius: 12px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 24px;
      background: rgba(255, 255, 255, 0.1);
      backdrop-filter: blur(10px);
      border: 1px solid rgba(255, 255, 255, 0.1);
      transition: all 0.3s ease;
    }

    .status-card:hover .card-icon {
      transform: scale(1.1) rotate(5deg);
      background: rgba(255, 255, 255, 0.15);
    }

    .card-progress {
      width: 100%;
      height: 10px;
      background-color: var(--gray-200);
      border-radius: 5px;
      overflow: hidden;
    }

    .card-progress-bar {
      height: 100%;
      transition: width 0.3s ease;
      border-radius: 5px;
    }

    /* 详细信息卡片 */
    .details-grid {
      display: grid;
      grid-template-columns: 1fr;
      gap: 16px;
      margin-bottom: 24px;
    }

    @media (min-width: 768px) {
      .details-grid {
        grid-template-columns: repeat(2, 1fr);
        gap: 20px;
      }
    }

    @media (min-width: 1024px) {
      .details-grid {
        grid-template-columns: repeat(2, 1fr);
        gap: 24px;
      }
    }

    @media (min-width: 1400px) {
      .details-grid {
        grid-template-columns: repeat(2, 1fr);
        gap: 28px;
      }
    }

    .info-card {
      background: linear-gradient(145deg, var(--gray-200), var(--gray-300));
      border-radius: 12px;
      padding: 16px;
      box-shadow: var(--shadow-md);
      border: 1px solid rgba(255, 255, 255, 0.05);
      transition: all 0.3s ease;
      /* 卡片滚动条样式 */
      scrollbar-width: thin;
      scrollbar-color: var(--gray-400) var(--gray-200);
    }

    .info-card::-webkit-scrollbar {
      width: 4px;
    }

    .info-card::-webkit-scrollbar-track {
      background: var(--gray-200);
      border-radius: 2px;
    }

    .info-card::-webkit-scrollbar-thumb {
      background: var(--gray-400);
      border-radius: 2px;
      transition: all 0.3s ease;
    }

    .info-card::-webkit-scrollbar-thumb:hover {
      background: var(--primary);
    }

    @media (min-width: 768px) {
      .info-card {
        padding: 20px;
      }
    }

    @media (min-width: 1024px) {
      .info-card {
        padding: 24px;
      }
    }

    .info-card:hover {
      transform: translateY(-2px);
      box-shadow: var(--shadow-lg);
    }

    .info-card-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 16px;
    }

    .info-card-title {
      font-size: 18px;
      font-weight: bold;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .info-card-title-icon {
      display: inline-block;
      width: 20px;
      text-align: center;
    }

    .refresh-btn {
      background: rgba(255, 255, 255, 0.1);
      border: 1px solid rgba(255, 255, 255, 0.2);
      color: var(--primary);
      cursor: pointer;
      font-size: 12px;
      padding: 6px 12px;
      border-radius: 6px;
      transition: all 0.3s ease;
      backdrop-filter: blur(10px);
      font-weight: 500;
    }

    @media (min-width: 768px) {
      .refresh-btn {
        font-size: 14px;
        padding: 8px 16px;
        border-radius: 8px;
      }
    }

    .refresh-btn:hover {
      background: rgba(96, 165, 250, 0.2);
      border-color: var(--primary);
      transform: translateY(-1px);
      box-shadow: 0 4px 12px rgba(96, 165, 250, 0.3);
    }

    /* 表格样式 */
    .info-table {
      width: 100%;
      border-collapse: collapse;
      margin-bottom: 20px;
    }

    .info-table td {
      padding: 12px 16px;
      border-bottom: 1px solid var(--gray-200);
    }

    .info-table .label {
      color: var(--gray-500);
    }

    .info-table .value {
      font-weight: 500;
    }

    .data-table {
      width: 100%;
      border-collapse: collapse;
      overflow-x: auto;
      display: block;
      -webkit-overflow-scrolling: touch;
      /* 表格滚动条样式 */
      scrollbar-width: thin;
      scrollbar-color: var(--gray-400) var(--gray-200);
    }

    .data-table::-webkit-scrollbar {
      height: 6px;
    }

    .data-table::-webkit-scrollbar-track {
      background: var(--gray-200);
      border-radius: 3px;
    }

    .data-table::-webkit-scrollbar-thumb {
      background: var(--gray-400);
      border-radius: 3px;
      border: 1px solid var(--gray-200);
      transition: all 0.3s ease;
    }

    .data-table::-webkit-scrollbar-thumb:hover {
      background: var(--primary);
    }

    @media (max-width: 768px) {
      .data-table {
        font-size: 14px;
      }
      
      .data-table th,
      .data-table td {
        padding: 8px 12px;
        white-space: normal;
        word-break: break-word;
      }
    }

    @media (max-width: 480px) {
      .data-table {
        font-size: 13px;
      }
      
      .data-table th,
      .data-table td {
        padding: 6px 8px;
      }
    }

    .data-table thead {
      background: linear-gradient(135deg, var(--gray-100), var(--gray-200));
      position: sticky;
      top: 0;
      backdrop-filter: blur(10px);
    }

    .data-table th,
    .data-table td {
      padding: 12px 16px;
      text-align: left;
      border-bottom: 1px solid var(--gray-200);
      white-space: nowrap;
    }

    .data-table th {
      font-size: 12px;
      font-weight: 500;
      text-transform: uppercase;
      color: var(--gray-500);
      letter-spacing: 0.05em;
    }

    .data-table tbody tr {
      transition: all 0.2s ease;
    }

    .data-table tbody tr:hover {
      background: linear-gradient(90deg, rgba(255, 255, 255, 0.05), rgba(255, 255, 255, 0.1));
      transform: translateX(4px);
    }

    /* 图表区域 */
    .chart-container {
      height: 200px;
      background-color: var(--gray-100);
      border-radius: 6px;
      margin-top: 24px;
      padding: 16px;
      position: relative;
      overflow: hidden;
    }

    .chart-title {
      font-size: 14px;
      font-weight: 600;
      color: var(--gray-600);
      margin-bottom: 16px;
    }

    /* 简单的图表实现 */
  .simple-chart {
    height: 140px;
    display: flex;
    align-items: flex-end;
    justify-content: space-between;
    padding: 0 8px;
  }

  .chart-bar {
    width: 4px;
    background-color: var(--primary);
    border-radius: 2px;
    transition: height 0.3s ease;
  }

  /* 基于日志的图表样式 */
  .log-chart-wrapper {
    display: flex;
    flex-direction: column;
    height: 160px;
    background: var(--card-bg);
    border: 1px solid var(--border-color);
    border-radius: 8px;
    padding: 10px;
  }

  .log-chart-container {
    display: flex;
    flex: 1;
    gap: 8px;
  }

  .chart-y-axis {
    display: flex;
    flex-direction: column;
    justify-content: space-between;
    width: 50px;
    font-size: 10px;
    color: var(--text-secondary);
    text-align: right;
    padding-right: 5px;
  }

  .chart-y-label {
    height: 20px;
    display: flex;
    align-items: center;
    justify-content: flex-end;
  }

  .chart-body {
    flex: 1;
    display: flex;
    align-items: end;
    gap: 2px;
    position: relative;
  }

  .chart-bar-container {
    flex: 1;
    display: flex;
    align-items: end;
    height: 100%;
  }

  /* 折线图样式 */
  .line-chart {
    width: 100%;
    height: 100%;
  }

  .line-point {
    transition: all 0.3s ease;
    cursor: pointer;
  }

  .line-point:hover {
    transform: translate(-50%, 50%) scale(1.5);
    box-shadow: 0 0 8px rgba(99, 102, 241, 0.5);
  }

  .chart-x-axis {
    display: flex;
    justify-content: space-between;
    padding: 5px 50px 0 50px;
    font-size: 10px;
    color: var(--text-secondary);
    border-top: 1px solid var(--border-color);
  }

  .chart-x-label {
    width: 20px;
    text-align: center;
  }

  /* 响应式调整 */
  @media (max-width: 768px) {
    .log-chart-wrapper {
      height: 140px;
      padding: 8px;
    }
    
    .chart-y-axis {
      width: 40px;
      font-size: 9px;
    }
    
    .chart-x-axis {
      padding: 5px 40px 0 40px;
      font-size: 9px;
    }
  }

  @media (max-width: 480px) {
    .log-chart-wrapper {
      height: 120px;
      padding: 5px;
    }
    
    .chart-y-axis {
      width: 35px;
      font-size: 8px;
    }
    
    .chart-x-axis {
      padding: 5px 35px 0 35px;
      font-size: 8px;
    }
  }

    /* 进度条样式 */
    .progress-container {
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .progress-bar {
      width: 96px;
      height: 8px;
      background-color: var(--gray-100);
      border-radius: 4px;
      overflow: hidden;
    }

    .progress-fill {
      height: 100%;
      border-radius: 4px;
    }

    .progress-text {
      font-size: 14px;
    }

    /* 页脚 */
    footer {
      background-color: var(--dark);
      color: white;
      padding: 24px 0;
      margin-top: 48px;
    }

    .footer-content {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 16px;
    }

    @media (min-width: 640px) {
      .footer-content {
        flex-direction: row;
        justify-content: space-between;
        align-items: center;
      }
    }

    .footer-info {
      display: flex;
      flex-direction: column;
      align-items: center;
    }

    @media (min-width: 640px) {
      .footer-info {
        align-items: flex-start;
      }
    }

    .footer-logo {
      display: flex;
      align-items: center;
      gap: 8px;
      font-weight: bold;
      margin-bottom: 4px;
    }

    .footer-description {
      color: var(--gray-400);
      font-size: 14px;
    }

    .footer-update-rate {
      font-size: 14px;
      color: var(--gray-400);
    }

    /* 图标替代 */
    .icon {
      font-weight: bold;
    }
  </style>
</head>
<body>
  <!-- 顶部导航栏 -->
  <header>
    <div class="container">
      <div class="header-content">
        <div class="logo">
          <span class="logo-icon">⚙️</span>
          <span class="logo-text">1914服务器状态监控</span>
        </div>
        <div class="system-info" id="system-info-header">
          <span id="os-name"></span> | 
          <span id="uptime"></span>
        </div>
      </div>
    </div>
  </header>

  <main class="dashboard">
    <div class="container">
      <!-- 状态概览卡片 -->
      <div class="cards-grid">
        <!-- CPU使用率卡片 -->
        <div class="status-card">
          <div class="card-header">
            <div class="card-info">
              <span class="card-label">CPU使用率</span>
              <span class="card-value" id="cpu-usage">--</span>
            </div>
            <div class="card-icon" style="background-color: rgba(59, 130, 246, 0.1); color: var(--primary)">
              <span class="icon">核</span>
            </div>
          </div>
          <div class="card-progress">
            <div id="cpu-usage-bar" class="card-progress-bar" style="background-color: var(--primary); width: 0%"></div>
          </div>
        </div>

        <!-- 内存使用率卡片 -->
        <div class="status-card">
          <div class="card-header">
            <div class="card-info">
              <span class="card-label">内存使用率</span>
              <span class="card-value" id="memory-usage">--</span>
            </div>
            <div class="card-icon" style="background-color: rgba(16, 185, 129, 0.1); color: var(--secondary)">
              <span class="icon">R</span>
            </div>
          </div>
          <div class="card-progress">
            <div id="memory-usage-bar" class="card-progress-bar" style="background-color: var(--secondary); width: 0%"></div>
          </div>
        </div>

        <!-- 磁盘使用率卡片 -->
        <div class="status-card">
          <div class="card-header">
            <div class="card-info">
              <span class="card-label">磁盘使用率</span>
              <span class="card-value" id="disk-usage">--</span>
            </div>
            <div class="card-icon" style="background-color: rgba(245, 158, 11, 0.1); color: var(--warning)">
              <span class="icon">H</span>
            </div>
          </div>
          <div class="card-progress">
            <div id="disk-usage-bar" class="card-progress-bar" style="background-color: var(--warning); width: 0%"></div>
          </div>
        </div>

        <!-- CPU温度卡片 -->
        <div class="status-card">
          <div class="card-header">
            <div class="card-info">
              <span class="card-label">CPU温度</span>
              <span class="card-value" id="cpu-temperature">--</span>
            </div>
            <div class="card-icon" style="background-color: rgba(239, 68, 68, 0.1); color: var(--danger)">
              <span class="icon">☀️</span>
            </div>
          </div>
          <div class="card-progress">
            <div id="cpu-temperature-bar" class="card-progress-bar" style="background-color: var(--danger); width: 0%"></div>
          </div>
        </div>

        <!-- 游戏端口状态卡片 -->
        <div class="status-card">
          <div class="card-header">
            <div class="card-info">
              <span class="card-label">游戏端口(8000)</span>
              <span class="card-value" id="game-port-status">--</span>
            </div>
            <div class="card-icon" style="background-color: rgba(139, 92, 246, 0.1); color: #8b5cf6">
              <span class="icon">C</span>
            </div>
          </div>
          <div class="card-progress">
            <div id="game-port-bar" class="card-progress-bar" style="background-color: #8b5cf6; width: 0%"></div>
          </div>
        </div>
      </div>

      <!-- 详细信息部分 -->
      <div class="details-grid">
        <!-- CPU详细信息 -->
        <div class="info-card">
          <div class="info-card-header">
            <h2 class="info-card-title">
              <span class="info-card-title-icon" style="color: var(--primary)"><span class="icon">⊞</span></span>
              CPU详细信息
            </h2>
            <button class="refresh-btn">刷新</button>
          </div>
          <table class="info-table">
            <tbody>
              <tr>
                <td class="label">型号</td>
                <td class="value" id="cpu-model"></td>
              </tr>
              <tr>
                <td class="label">核心数</td>
                <td class="value" id="cpu-cores"></td>
              </tr>
              <tr>
                <td class="label">线程数</td>
                <td class="value" id="cpu-threads"></td>
              </tr>
              <tr>
                <td class="label">频率</td>
                <td class="value" id="cpu-speed"></td>
              </tr>
            </tbody>
          </table>
          <div class="chart-container">
            <div class="chart-title">CPU负载图表</div>
            <div id="cpu-chart" class="simple-chart"></div>
          </div>
        </div>

        <!-- 内存详细信息 -->
        <div class="info-card">
          <div class="info-card-header">
            <h2 class="info-card-title">
              <span class="info-card-title-icon" style="color: var(--secondary)"><span class="icon">□</span></span>
              内存详细信息
            </h2>
            <button class="refresh-btn">刷新</button>
          </div>
          <table class="info-table">
            <tbody>
              <tr>
                <td class="label">总内存</td>
                <td class="value" id="memory-total"></td>
              </tr>
              <tr>
                <td class="label">已用内存</td>
                <td class="value" id="memory-used"></td>
              </tr>
              <tr>
                <td class="label">空闲内存</td>
                <td class="value" id="memory-free"></td>
              </tr>
              <tr>
                <td class="label">交换内存</td>
                <td class="value" id="memory-swap"></td>
              </tr>
            </tbody>
          </table>
          <div class="chart-container">
            <div class="chart-title">内存使用图表</div>
            <div id="memory-chart" class="simple-chart"></div>
          </div>
        </div>
      </div>

      <!-- 磁盘和网络信息 -->
      <div class="details-grid">
        <!-- 磁盘信息 -->
        <div class="info-card">
          <div class="info-card-header">
            <h2 class="info-card-title">
              <span class="info-card-title-icon" style="color: var(--warning)"><span class="icon">▣</span></span>
              磁盘信息
            </h2>
            <button class="refresh-btn">刷新</button>
          </div>
          <table class="data-table">
            <thead>
              <tr>
                <th>设备</th>
                <th>挂载点</th>
                <th>总大小</th>
                <th>已用</th>
                <th>可用</th>
                <th>使用率</th>
              </tr>
            </thead>
            <tbody id="disk-table-body">
              <!-- 磁盘数据将通过JavaScript动态填充 -->
            </tbody>
          </table>
        </div>

        <!-- 端口状态信息 -->
        <div class="info-card">
          <div class="info-card-header">
            <h2 class="info-card-title">
              <span class="info-card-title-icon" style="color: #8b5cf6"><span class="icon">🎮</span></span>
              端口状态监控
            </h2>
            <button class="refresh-btn">刷新</button>
          </div>
          <table class="data-table">
            <thead>
              <tr>
                <th>端口</th>
                <th>名称</th>
                <th>状态</th>
                <th>最后检测</th>
              </tr>
            </thead>
            <tbody id="ports-table-body">
              <!-- 端口数据将通过JavaScript动态填充 -->
            </tbody>
          </table>
        </div>
      </div>

      <!-- 网络信息 -->
      <div class="info-card">
        <div class="info-card-header">
          <h2 class="info-card-title">
            <span class="info-card-title-icon" style="color: var(--primary)"><span class="icon">≡</span></span>
            网络信息
          </h2>
          <button class="refresh-btn">刷新</button>
        </div>
        <table class="data-table">
          <thead>
            <tr>
              <th>接口</th>
              <th>IP地址</th>
              <th>接收(MB)</th>
              <th>发送(MB)</th>
            </tr>
          </thead>
          <tbody id="network-table-body">
            <!-- 网络数据将通过JavaScript动态填充 -->
          </tbody>
        </table>
        <div class="chart-container">
          <div class="chart-title">网络流量图表</div>
          <div id="network-chart" class="simple-chart"></div>
        </div>
      </div>
    </div>
  </main>

  <footer>
    <div class="container">
      <div class="footer-content">
        <div class="footer-info">
          <div class="footer-logo">
            <span>⚙️</span>
            <span>Linux系统状态监控</span>
          </div>
          <p class="footer-description">实时监控TGW服务器系统状态</p>
        </div>
        <div class="footer-update-rate">
          <p>数据刷新间隔: <span id="refresh-rate">5</span>秒</p>
          <p>由<span id="last-update">CLUMM</span>开发</p>
        </div>
      </div>
    </div>
  </footer>

  <script>
    // 格式化数字（如内存大小）
    function formatBytes(bytes, decimals = 2) {
      if (bytes === 0) return '0 Bytes';
      const k = 1024;
      const dm = decimals < 0 ? 0 : decimals;
      const sizes = ['Bytes', 'KB', 'MB', 'GB', 'TB'];
      const i = Math.floor(Math.log(bytes) / Math.log(k));
      return parseFloat((bytes / Math.pow(k, i)).toFixed(dm)) + ' ' + sizes[i];
    }

    // 历史数据数组
    let cpuHistory = Array(30).fill(0);
    let memoryHistory = Array(30).fill(0);
    let networkRxHistory = Array(30).fill(0);
    let networkTxHistory = Array(30).fill(0);
    
    // 从日志获取历史数据（限制数据点数量）
    async function loadHistoricalData(type, limit = 20) {
      try {
        const response = await fetch(`/api/logs?type=${type}`);
        const data = await response.json();
        
        if (data.logs && data.logs.length > 0) {
          // 直接取最新的limit条数据，避免用0填充
          const historicalData = data.logs
            .slice(-limit) // 取最新的limit条
            .map(log => {
              if (type === 'cpu') return log.data.load || 0;
              if (type === 'memory') return log.data.usage || 0;
              if (type === 'network') return (log.data.rx_bytes || 0) / 1024 / 1024;
              return 0;
            });
          
          return historicalData;
        }
      } catch (error) {
        console.error(`加载${type}历史数据失败:`, error);
      }
      return []; // 返回空数组而不是填充0值
    }

    // 创建基于日志数据的详细图表
    function createLogBasedChart(containerId, data, type = 'cpu', color = '#3b82f6') {
      const container = document.getElementById(containerId);
      if (!container) return;
      
      // 清空容器
      container.innerHTML = '';
      
      // 创建图表容器
      const chartWrapper = document.createElement('div');
      chartWrapper.className = 'log-chart-wrapper';
      
      // 创建Y轴标签
      const yAxis = document.createElement('div');
      yAxis.className = 'chart-y-axis';
      
      // 根据类型设置Y轴标签
      const maxValue = Math.max(...data, 100);
      const yLabels = [maxValue, maxValue * 0.75, maxValue * 0.5, maxValue * 0.25, 0];
      
      yLabels.forEach(label => {
        const yLabel = document.createElement('div');
        yLabel.className = 'chart-y-label';
        yLabel.textContent = type === 'cpu' || type === 'memory' ? 
          `${Math.round(label)}%` : 
          `${Math.round(label)}MB`;
        yAxis.appendChild(yLabel);
      });
      
      // 创建图表主体
      const chartBody = document.createElement('div');
      chartBody.className = 'chart-body';
      
      // 创建X轴
      const xAxis = document.createElement('div');
      xAxis.className = 'chart-x-axis';
      
      // 如果是网络图表，使用折线图
      if (type === 'network') {
        // 创建折线图容器
        const lineChart = document.createElement('div');
        lineChart.className = 'line-chart';
        lineChart.style.position = 'relative';
        lineChart.style.height = '100%';
        lineChart.style.width = '100%';
        
        // 创建折线路径
        const svg = document.createElementNS('http://www.w3.org/2000/svg', 'svg');
        svg.setAttribute('width', '100%');
        svg.setAttribute('height', '100%');
        svg.style.position = 'absolute';
        svg.style.top = '0';
        svg.style.left = '0';
        
        // 创建折线路径
        const path = document.createElementNS('http://www.w3.org/2000/svg', 'path');
        path.setAttribute('fill', 'none');
        path.setAttribute('stroke', color);
        path.setAttribute('stroke-width', '2');
        
        // 计算折线路径
        const points = data.map((value, index) => {
          const x = (index / (data.length - 1)) * 100;
          const y = 100 - (value / maxValue) * 100;
          return `${x},${y}`;
        }).join(' L ');
        
        path.setAttribute('d', `M ${points}`);
        svg.appendChild(path);
        
        // 添加数据点
        data.forEach((value, index) => {
          const point = document.createElement('div');
          point.className = 'line-point';
          point.style.position = 'absolute';
          point.style.width = '6px';
          point.style.height = '6px';
          point.style.backgroundColor = color;
          point.style.borderRadius = '50%';
          point.style.left = `${(index / (data.length - 1)) * 100}%`;
          point.style.bottom = `${(value / maxValue) * 100}%`;
          point.style.transform = 'translate(-50%, 50%)';
          
          // 添加悬停提示
          point.title = `网络流量: ${value.toFixed(1)}MB`;
          
          lineChart.appendChild(point);
        });
        
        lineChart.appendChild(svg);
        chartBody.appendChild(lineChart);
        
      } else {
        // CPU和内存使用柱状图
        data.forEach((value, index) => {
          const barContainer = document.createElement('div');
          barContainer.className = 'chart-bar-container';
          
          const bar = document.createElement('div');
          bar.className = 'chart-bar';
          bar.style.backgroundColor = color;
          
          // 设置高度，确保即使为0也有最小高度
          const height = value > 0 ? (value / maxValue) * 100 : 1;
          bar.style.height = `${height}%`;
          
          // 添加悬停提示
          bar.title = type === 'cpu' ? 
            `CPU负载: ${value.toFixed(1)}%` : 
            `内存使用: ${value.toFixed(1)}%`;
          
          barContainer.appendChild(bar);
          chartBody.appendChild(barContainer);
        });
      }
      
      // 每5个数据点添加一个X轴标签
      data.forEach((value, index) => {
        if (index % 5 === 0) {
          const xLabel = document.createElement('div');
          xLabel.className = 'chart-x-label';
          xLabel.textContent = `${index + 1}`;
          xAxis.appendChild(xLabel);
        }
      });
      
      // 组装图表
      const chartContainer = document.createElement('div');
      chartContainer.className = 'log-chart-container';
      chartContainer.appendChild(yAxis);
      chartContainer.appendChild(chartBody);
      
      chartWrapper.appendChild(chartContainer);
      chartWrapper.appendChild(xAxis);
      
      container.appendChild(chartWrapper);
    }

    // 更新图表（历史数据叠加显示）
    async function updateCharts(cpuUsage, memoryUsage, networkRx, networkTx) {
      // 更新实时历史数据
      cpuHistory.shift();
      cpuHistory.push(cpuUsage);
      memoryHistory.shift();
      memoryHistory.push(memoryUsage);
      networkRxHistory.shift();
      networkRxHistory.push(networkRx);
      networkTxHistory.shift();
      networkTxHistory.push(networkTx);
      
      try {
        // 加载历史数据
        const cpuHistoricalData = await loadHistoricalData('cpu', 20);
        const memoryHistoricalData = await loadHistoricalData('memory', 20);
        
        // 智能合并数据：优先使用历史数据，不足时用实时数据补充
        let combinedCpuData = [];
        let combinedMemoryData = [];
        
        if (cpuHistoricalData.length > 0) {
          // 如果有历史数据，显示历史数据
          combinedCpuData = cpuHistoricalData.slice(-20); // 最多显示20个历史数据点
        } else {
          // 如果没有历史数据，使用实时数据
          combinedCpuData = cpuHistory;
        }
        
        if (memoryHistoricalData.length > 0) {
          combinedMemoryData = memoryHistoricalData.slice(-20);
        } else {
          combinedMemoryData = memoryHistory;
        }
        
        // 创建图表
        createLogBasedChart('cpu-chart', combinedCpuData, 'cpu', '#3b82f6');
        createLogBasedChart('memory-chart', combinedMemoryData, 'memory', '#10b981');
        
        // 网络图表使用实时数据
        const combinedNetwork = networkRxHistory.map((rx, i) => rx + networkTxHistory[i]);
        createLogBasedChart('network-chart', combinedNetwork, 'network', '#6366f1');
        
      } catch (error) {
        console.error('更新图表失败:', error);
        // 出错时使用实时数据
        createLogBasedChart('cpu-chart', cpuHistory, 'cpu', '#3b82f6');
        createLogBasedChart('memory-chart', memoryHistory, 'memory', '#10b981');
        const combinedNetwork = networkRxHistory.map((rx, i) => rx + networkTxHistory[i]);
        createLogBasedChart('network-chart', combinedNetwork, 'network', '#6366f1');
      }
    }

    // 获取并更新CPU信息
    async function updateCPUInfo() {
      try {
        const response = await fetch('/api/cpu');
        const data = await response.json();
        
        // 更新CPU基本信息
        document.getElementById('cpu-model').textContent = data.info?.brand || '未知';
        document.getElementById('cpu-cores').textContent = data.info?.cores || '未知';
        document.getElementById('cpu-threads').textContent = data.info?.physicalCores || '未知';
        document.getElementById('cpu-speed').textContent = data.info?.speed ? `${data.info.speed} GHz` : '未知';
        
        // 更新CPU使用率
        const cpuUsage = data.load?.currentLoad || 0;
        document.getElementById('cpu-usage').textContent = `${cpuUsage.toFixed(1)}%`;
        document.getElementById('cpu-usage-bar').style.width = `${cpuUsage}%`;
        
        // 更新CPU温度
        const cpuTemp = data.temperature?.main || 0;
        document.getElementById('cpu-temperature').textContent = cpuTemp ? `${cpuTemp}°C` : '未知';
        const tempPercentage = Math.min((cpuTemp / 100) * 100, 100);
        document.getElementById('cpu-temperature-bar').style.width = `${tempPercentage}%`;
        
        return cpuUsage;
      } catch (error) {
        console.error('更新CPU信息失败:', error);
        return 0;
      }
    }

    // 获取并更新内存信息
    async function updateMemoryInfo() {
      try {
        const response = await fetch('/api/memory');
        const data = await response.json();
        
        // 更新内存基本信息
        document.getElementById('memory-total').textContent = data.total ? formatBytes(data.total) : '未知';
        document.getElementById('memory-used').textContent = data.used ? formatBytes(data.used) : '未知';
        document.getElementById('memory-free').textContent = data.free ? formatBytes(data.free) : '未知';
        document.getElementById('memory-swap').textContent = data.swapTotal ? formatBytes(data.swapTotal) : '未知';
        
        // 更新内存使用率
        const memoryUsage = data.total && data.used ? (data.used / data.total) * 100 : 0;
        document.getElementById('memory-usage').textContent = `${memoryUsage.toFixed(1)}%`;
        document.getElementById('memory-usage-bar').style.width = `${memoryUsage}%`;
        
        return memoryUsage;
      } catch (error) {
        console.error('更新内存信息失败:', error);
        return 0;
      }
    }

    // 获取并更新磁盘信息
    async function updateDiskInfo() {
      try {
        const response = await fetch('/api/disk');
        const data = await response.json();
        const diskTableBody = document.getElementById('disk-table-body');
        diskTableBody.innerHTML = '';
        
        // 计算总磁盘使用率
        let totalSize = 0;
        let totalUsed = 0;
        
        // 更新磁盘表
        if (data.fsSize && Array.isArray(data.fsSize)) {
          data.fsSize.forEach(disk => {
            const total = disk.size || 0;
            const available = disk.available || 0;
            const used = total - available;
            const usage = total > 0 ? (used / total) * 100 : 0;
            
            totalSize += total;
            totalUsed += used;
            
            const row = document.createElement('tr');
            row.innerHTML = `
              <td>${disk.fs || '未知'}</td>
              <td>${disk.mount || '未知'}</td>
              <td>${formatBytes(total)}</td>
              <td>${formatBytes(used)}</td>
              <td>${formatBytes(available)}</td>
              <td>
                <div class="progress-container">
                  <div class="progress-bar">
                    <div class="progress-fill" style="width: ${usage}%; background-color: ${usage > 80 ? '#ef4444' : usage > 60 ? '#f59e0b' : '#10b981'}"></div>
                  </div>
                  <span class="progress-text">${usage.toFixed(1)}%</span>
                </div>
              </td>
            `;
            diskTableBody.appendChild(row);
          });
        } else {
          // 添加占位行表示数据加载失败
          const row = document.createElement('tr');
          row.innerHTML = '<td colspan="6" style="text-align: center; color: #6b7280;">无法加载磁盘信息</td>';
          diskTableBody.appendChild(row);
        }
        
        // 更新总磁盘使用率
        const totalUsage = totalSize > 0 ? (totalUsed / totalSize) * 100 : 0;
        document.getElementById('disk-usage').textContent = `${totalUsage.toFixed(1)}%`;
        document.getElementById('disk-usage-bar').style.width = `${totalUsage}%`;
      } catch (error) {
        console.error('更新磁盘信息失败:', error);
        const diskTableBody = document.getElementById('disk-table-body');
        diskTableBody.innerHTML = '<tr><td colspan="6" style="text-align: center; color: #6b7280;">无法加载磁盘信息</td></tr>';
      }
    }

    // 获取并更新网络信息
    async function updateNetworkInfo() {
      try {
        const response = await fetch('/api/network');
        const data = await response.json();
        const networkTableBody = document.getElementById('network-table-body');
        networkTableBody.innerHTML = '';
        
        // 计算总网络流量
        let totalRx = 0;
        let totalTx = 0;
        
        // 更新网络表
        if (data.stats && Array.isArray(data.stats)) {
          data.stats.forEach(stat => {
            // 过滤掉lo接口
            if (stat.iface === 'lo') return;
            
            const rxMB = (stat.rx_bytes / 1024 / 1024).toFixed(2);
            const txMB = (stat.tx_bytes / 1024 / 1024).toFixed(2);
            
            totalRx += parseFloat(rxMB);
            totalTx += parseFloat(txMB);
            
            // 查找对应的接口信息获取IP
            const interfaceInfo = data.interfaces?.find(intf => intf.iface === stat.iface);
            const ipAddress = interfaceInfo?.ip4 || '无IP';
            
            const row = document.createElement('tr');
            row.innerHTML = `
              <td>${stat.iface}</td>
              <td>${ipAddress}</td>
              <td>${rxMB}</td>
              <td>${txMB}</td>
            `;
            networkTableBody.appendChild(row);
          });
        } else {
          // 添加占位行表示数据加载失败
          const row = document.createElement('tr');
          row.innerHTML = '<td colspan="4" style="text-align: center; color: #6b7280;">无法加载网络信息</td>';
          networkTableBody.appendChild(row);
        }
        
        return { rx: totalRx / 5, tx: totalTx / 5 }; // 估算每秒速率（基于5秒刷新间隔）
      } catch (error) {
        console.error('更新网络信息失败:', error);
        const networkTableBody = document.getElementById('network-table-body');
        networkTableBody.innerHTML = '<tr><td colspan="4" style="text-align: center; color: #6b7280;">无法加载网络信息</td></tr>';
        return { rx: 0, tx: 0 };
      }
    }

    // 获取并更新系统信息
    async function updateSystemInfo() {
      try {
        const response = await fetch('/api/system');
        const data = await response.json();
        
        // 更新系统信息
        document.getElementById('os-name').textContent = data.os ? `${data.os.distro || '未知'} ${data.os.release || ''}` : '未知';
        
        // 格式化运行时间
        const uptimeSeconds = data.uptime || 0;
        const days = Math.floor(uptimeSeconds / (24 * 60 * 60));
        const hours = Math.floor((uptimeSeconds % (24 * 60 * 60)) / (60 * 60));
        const minutes = Math.floor((uptimeSeconds % (60 * 60)) / 60);
        let uptimeString = '';
        if (days > 0) uptimeString += `${days}天 `;
        if (hours > 0) uptimeString += `${hours}小时 `;
        if (minutes > 0) uptimeString += `${minutes}分钟`;
        document.getElementById('uptime').textContent = uptimeString || '未知';
      } catch (error) {
        console.error('更新系统信息失败:', error);
      }
    }

    // 获取端口状态信息
    async function getPortsStatus() {
      try {
        const response = await fetch('/api/ports');
        const data = await response.json();
        return data;
      } catch (error) {
        console.error('获取端口状态失败:', error);
        return [];
      }
    }

    // 更新端口状态显示
    function updatePortsStatus(portsData) {
      const gamePortElement = document.getElementById('game-port-status');
      const gamePortBar = document.getElementById('game-port-bar');
      const portsTableBody = document.getElementById('ports-table-body');
      
      // 查找游戏端口状态
      const gamePort = portsData.find(port => port.port === 8000);
      
      if (gamePort) {
        // 更新游戏端口卡片
        if (gamePort.status === 'open') {
          gamePortElement.textContent = '开放';
          gamePortBar.style.width = '100%';
          gamePortBar.style.backgroundColor = '#10b981';
        } else if (gamePort.status === 'timeout') {
          gamePortElement.textContent = '超时';
          gamePortBar.style.width = '50%';
          gamePortBar.style.backgroundColor = 'var(--warning)';
        } else {
          gamePortElement.textContent = '关闭';
          gamePortBar.style.width = '10%';
          gamePortBar.style.backgroundColor = 'var(--danger)';
        }
      }
      
      // 更新端口状态表格
      portsTableBody.innerHTML = '';
      portsData.forEach(port => {
        const row = document.createElement('tr');
        
        // 状态颜色
        let statusColor = 'var(--danger)';
        let statusText = '关闭';
        if (port.status === 'open') {
          statusColor = '#10b981';
          statusText = '开放';
        } else if (port.status === 'timeout') {
          statusColor = 'var(--warning)';
          statusText = '超时';
        }
        
        row.innerHTML = `
          <td>${port.port}</td>
          <td>${port.name}</td>
          <td style="color: ${statusColor}">${statusText}</td>
          <td>${new Date().toLocaleTimeString()}</td>
        `;
        
        portsTableBody.appendChild(row);
      });
    }

    // 主更新函数
    async function updateAllInfo() {
      const cpuUsage = await updateCPUInfo();
      const memoryUsage = await updateMemoryInfo();
      await updateDiskInfo();
      const networkStats = await updateNetworkInfo();
      await updateSystemInfo();
      
      // 获取并更新端口状态
      const portsData = await getPortsStatus();
      updatePortsStatus(portsData);
      
      // 更新图表
      await updateCharts(cpuUsage, memoryUsage, networkStats.rx, networkStats.tx);
    }

    // 初始化
    window.onload = async () => {
      // 更新系统信息
      await updateAllInfo();
      
      // 设置定时刷新
      setInterval(updateAllInfo, 5000);
    };
  </script>
</body>
</html>